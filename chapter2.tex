\chapter{Related Work}

In this chapter, we present the most relevant research results that guided our work, exposing the methodologies used by the authors and how they correlate to ours. Research on automatic pain assessment has a significant intersection between the medical field and applied machine learning both for fetuses and infants \citep{Bellieni2012, ZamzmiPGKSA16}. Thus, we start by exploring the signs of pain in infants and fetuses, their main indicators, the available pain scales to measure them, and automatic methods of assessment. We conclude the chapter by explaining how our work is different from the mentioned ones, as we explore automatic pain assessment from a novel perspective with fetuses.

\section{Pain}

Pain is a universal form of distress present in humans and some other animals. Acute and chronic pain is very typical in the population and constitutes widespread public health problems \citep{Goldberg2011}. Its prolonged presence could cause many adverse consequences, including psychological effects, which is especially true in the case of neonates and fetuses.

The study of neonatal pain appears to have begun as early as the 1870s when Dr.\ Flechsig proposed it was unlikely that neonates could feel pain because their neuronal myelination was not complete \citep{cope1998neonatal}. Charles Darwin's book written a couple of years later agreed with this view, as he wrote that ``infant's pain expressions were related to reflexes only'' \citep{darwin1872expression}. Even in the 1950s, some pediatric surgeries were still performed without analgesia and anesthesia \citep{cope1998neonatal}.

It was only in the early 1980s that the first fetal surgery was performed by Dr. Michael Harrison \citep{Harrison1982}. The fetus to be operated had a blockage in the urinary tract that caused the kidney to dangerously extend, which is a condition known as congenital hydronephrosis. A vesicostomy was conducted to correct this issue by placing a catheter in the fetus to allow the urine to be released normally.

Further progress has been made in the years since the first operation, as advances in imaging technology and in surgery techniques allowed additional abnormalities to be treated and for less invasive forms of fetal surgical intervention to be performed.

Even though the cases in which fetal surgery is necessary are relatively rare, it has become the standard form of intervention in some abnormalities like myelomeningocele, as shown by the Management of Myelomeningocele (MOMS) trial \citep{Adzick2011}. The study compared outcomes of in utero repair (before birth) with standard postnatal repair (after birth). The conclusion was that prenatal repair might result in better neurological function than repair deferred until after delivery.

A follow-up cohort study by the same study group has evaluated children originally enrolled in the MOMS trial, who are now in their school age (5.9 â€“ 10.3 years old) \citep{Houtrow2020}. They discovered that, even though there were no significant differences in adaptive behavior, motor function and quality of life were significantly better in the group with prenatal repair.

The study of fetal surgery is tightly coupled with the one of fetal pain. \cite{Fisk2001}, for instance, evaluated the effect of opioid analgesia on fetal hormonal stress responses to intrauterine needling and showed that fentanyl, an opioid commonly used for pain medication and anesthesia, does attenuate the fetal stress responses.

Later on, \cite{vandeVelde2012} studied fetal reactions to painful stimuli and showed that painful interventions could have long-term effects on them. This study also concluded that adequate pain relief during potentially painful procedures is recommended, as it leads not only to better fetus well-being, but also helps with fetus immobilization, which prevents accidental fetal movements complicating these procedures. 

These conclusions also affect anesthesiologists, as \cite{Devoto2017} shows that fetal pain is among their primary concerns during fetal surgery for myelomeningocele. Considering these procedures are so delicate, fetal pain assessment and management are of fundamental help, which leads research to the study of pain detection through the use of pain indicators.

\subsection{Pain Indicators}

Fetuses and infants can produce different signals of pain, which can be decoded to both identify its presence and to measure its level. These signals come from a variety of sources, such as facial expressions, crying sounds, body movements, physiological indicators, and biological markers \citep{Bellieni2012}. 

Even though we have this many indicators, pain identification is a challenging task as we have the manifestation of the same indicators present in similar feelings, such as anger, hunger, or stress. The recommendation to address this issue is that these indicators should be used in combination with each other \citep{Bellieni2012} because most of the time, their presence alone is not sufficient. 

Crying, for instance, can also be generated by hunger or anger which implies it can not be used as a sole indicator of pain.  Thus, pain scales normally combine features of crying with other indicators for pain assessment. Fetuses have been shown to express a homolog of crying \citep{Gingras2005}, which can also be further explored for automatic pain assessment, as shown by \cite{abs-1909-02543}. 

Physiological indicators, on the other hand, have the limitation that they are subject to variations due to underlying illness \citep{sweet1998physiological}. Body movements have also been pointed out to be indicators of pain, as fetuses already present withdrawn reflexes during stressful procedures \citep{Zimmermann1991}, but care must be taken as they can also be misleading as other factors may cause the movements.

Studies have also shown that biological markers like stress hormones (cortisol, adrenaline, and beta-endorphins) are increased in concentration in the blood in the presence of pain \citep{giannakoulopoulos1994fetal}. However, the problem of these indicators is that they depend on results from laboratory tests, which makes it unfeasible to use during clinical procedures.

One of the most relevant indicators of pain, not only in adults but also in neonates and fetuses are facial expressions. As suggested by \cite{Yan2006}, a great way of evaluating fetal facial expressions is through the means of 4-D sonography, and as he points out, these studies may be the key to predicting fetal brain function and well-being. Later research by \cite{Reissland2011, Reissland2013} also suggests that, when healthy fetuses mature from 24 to 26 weeks of gestation, their capability of showing complex facial movements increases, and they were even able to observe facial expressions which resemble a face while in pain or distress.

Facial expression indicators are frequently present in pain scales. Several facial movements are usually tracked, such as brow bulge, eye squeeze, nasolabial furrow, and open mouth. The assessment of these manifestations is done by observers, which use pain scales to identify its presence and intensity of pain.

\subsection{Pain Scales}

Multidimensional neonatal pain scales were developed using the many indicators mentioned in the previous section. These scales are used by caregivers to assess pain with behavioral and physiological indicators. The most popular ones are:

\begin{itemize}
    \item Neonatal Infant Pain Scale (NIPS), by \cite{Lawrence1993}
    \item Face, Legs, Activity, Crying and Consolability (FLACC), by \cite{Merkel1996}
    \item Neonatal Facial Coding System (NFCS), by \cite{Grunau1998}
\end{itemize}

These scales were all developed targeting neonates, as some indicator observations are not easily measured in a fetus due to the difficulties of collecting images of their faces. However, recent studies by \cite{bernardes2018feasibility} have reported that the use of the NFCS is feasible to detect pain-related facial expressions compared with control conditions in a randomized and blinded assessment report. We further discuss this study in Chapter 4.

Nevertheless, the scales also have some limitations, as they are highly dependent on the observant's bias, require specific training for proper utilization, and are not able to monitor pain in a continuous manner. Thus developing tools that are capable of addressing this task automatically and continuously is highly compelling as they can result in a more consistent pain assessment.

\section{Learning Models for Pain Assessment}

The development of learning models to automatically assess pain has been a popular topic of research lately. As an example, for adults pain assessment, \citep{MauricioCVC19} has achieved remarkable results in identifying spatiotemporal features extracted from video sequences for pain recognition.

In terms of neonates, the first work attempting to assess pain automatically emerged in 2006 with the development of the iCOPE database \citep{Brahnam2006}. The database consisted of 204 images from 26 infants. The images were collected in five different conditions, a resting baseline, with bodily disturbance, with an air stimulus on the nose, with friction on the external surface of the heel, and with the pain of a heel stick. The idea behind using this variety of conditions was to make sure the set of images were representative of the many possible situations, but also challenging enough to discriminate. The five conditions were later divided into two groups for classification: pain and non-pain.

Their studies considered the best scenario where the system would be able to train on a fetus and evaluate that same fetus later on. However, as permanence in the baby nursery is quite short, they also experimented with the case where this was not possible, thus developing a validation process where the classifier had to be trained beforehand and evaluated on images of a new infant, which was not in the dataset distribution previously. Given they had a small number of subjects, it was feasible to use a validation strategy known as leave-one-out, which consisted of iterating over every combination of using 25 subjects for training and 1 for testing. 

At the time, neural networks were not as popular and advanced as they are today. Thus, the first attempts to automatically detect pain used traditional algorithms such as Principal Component Analysis (PCA), Linear Discriminant Analysis (LDA), and Support Vector Machines (SVM) \citep{BrahnamCSS05, Brahnam2006, BrahnamNS08}. In order to extract features from the images, these studies relied heavily on texture descriptors like Local Binary Patterns (LBP) and a few other variations \cite{Nanni2010}. Still, the results were satisfactory, and the experimental process they developed is similar to what is used today with more modern techniques. 

\cite{ZamzamiPGKAS16}, more recently, proposes a multimodal approach for automatic pain assessment, which combines a few indicators like facial expressions, body movements, and changes in vital signs for producing a pain score. This score was evaluated on videos of 18 infants recorded at the Neonatal Intensive Care Unit (NICU) of the Tampa General Hospital, and the multimodal approach performed much better than each individual indicator on its own, by achieving 95\% accuracy for pain classification. A later cohort study also included crying sounds into the model and yielded an accuracy of 96.6\% \citep{Zamzmi2017}.

Modern approaches in automatic pain assessment of neonates make the use of deep neural networks to achieve state of the art results. \cite{abs-1807-01631}, for instance, has significantly improved the results in the aforementioned iCOPE database, achieving 0.948 of AUC by combining both handcrafted features and features extracted by Convolutional Neural Networks (CNNs) using transfer learning.  

\cite{Zamzmi2019}, in a similar study, has compared the use of popular CNNs, such as VGG and ResNet, with a network particularly tailored for neonatal pain assessment, the N-CNN. To evaluate the networks, they have also recorded videos at the NICU of the Tampa General Hospital, where a camera was installed on a stand next to the neonate's incubator, targeting their faces. These recordings resulted in the Neonatal Pain Assessment Dataset (NPAD), which consists of 31 neonates and are available at the study's website \footnote{\url{https://rpal.cse.usf.edu/project\_neonatal\_pain}}. Their findings suggest that automatic recognition of neonatal pain using these networks is not only viable but also a more efficient alternative to the current standard of pain assessment, which relies on caregivers.

New studies, like \cite{Fotiadou2014}, have also been using videos directly as inputs to the learning models. \cite{SalekinZGKH019}, for instance, has proposed a multi-channel shared network to classify pain from videos by extracting features from facial expressions and body movements. Likewise, \citep{Zhi2018b} proposes the use of dynamic facial texture features and dynamic geometric features to extract features from video sequences and use them to classify facial expressions of infants as pain or no pain. These techniques take advantage of the spatiotemporal sequence of the frames, to create a time series of frame-level features. \citep{abs-1909-02543} also contributed with an alternative approach by using convolutional neural networks to extract features from crying sounds. 

Our work has adopted a similar approach of not having only images of rest and pain, but also a third set of images from another stimulus, which in our case was a vibro-acoustic sound with the intention of causing discomfort, but no pain. As for the validation strategy, we have also adopted the leave-one-out method used by \cite{Brahnam2006}. Like \cite{abs-1807-01631}, we relied heavily on the use of transfer learning to train our convolutional neural networks, given we have limited data available. For the same reason, we have also used data augmentation, which was very common in many of the mentioned studies due to data limitation. To the best of our knowledge, our work is the first attempt to detect pain in fetuses automatically, and we believe many of the approaches mentioned earlier have the potential to help in this task. 